# Apache common configuration for IEM Web Farm
# Variables available for apache configuration file usage (not ENV vars)
# IEMWEBFARM_MAPSERV -- path to the mapserv binary
# IEMWEBFARM_LOGROOT -- path to log directory

<IfDefine !IEMWEBFARM_MAPSERV>
    Define IEMWEBFARM_MAPSERV /opt/miniconda3/envs/prod/bin/mapserv
</IfDefine>

<IfDefine !IEMWEBFARM_LOGROOT>
    Define IEMWEBFARM_LOGROOT /mesonet/www/logs
</IfDefine>

# Figure out if we were proxied or not
SetEnvIf X-Forwarded-For "^([0-9a-fA-F])" PROXY

# Major dragons here as we attempt to have log files generated with
# increasing timestamps
LogFormat "%{X-Forwarded-For}i %l %u %{end:}t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" proxy_combined
LogFormat "%h %l %u %{end:}t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" non_proxy_combined
